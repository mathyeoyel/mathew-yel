<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Mathew Yel</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://upload-widget.cloudinary.com https://widget.cloudinary.com; style-src 'self' 'unsafe-inline' https://upload-widget.cloudinary.com; img-src 'self' data: https: blob:; connect-src 'self' https://api.cloudinary.com https://*.cloudinary.com; font-src 'self' data:; frame-src https://widget.cloudinary.com https://upload-widget.cloudinary.com; form-action 'self'; frame-ancestors 'none';">
    <script src="/auth.js"></script>
    <script src="/csrf.js"></script>
    <script src="/validation.js"></script>
    <script src="/security-config.js"></script>
    
    <!-- Cloudinary Upload Widget -->
    <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
    <style>
        :root {
            --bg: #0b0d13;
            --card: #121521;
            --muted: #a7b0c0;
            --text: #f2f4f8;
            --accent: #5dd0ff;
            --border: #22283a;
            --success: #8ff0a7;
            --warning: #ffb366;
            --error: #ff6b6b;
            --gradient: linear-gradient(135deg, #5dd0ff, #a1ffce);
        }
        
        :root.light {
            --bg: #f7f9fc;
            --card: #ffffff;
            --muted: #52607a;
            --text: #0b1020;
            --accent: #0066ff;
            --border: #e6eaf2;
            --success: #28a745;
            --warning: #ffc107;
            --error: #dc3545;
            --gradient: linear-gradient(135deg, #0066ff, #28a745);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .admin-header {
            background: var(--card);
            padding: 30px;
            border-radius: 16px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }

        .admin-header h1 {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            font-size: 2.5rem;
            font-weight: 800;
        }

        .admin-header p {
            color: var(--muted);
            font-size: 1.1rem;
        }

        /* Theme Toggle Button */
        .theme-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: var(--accent);
            color: var(--bg);
            transform: translateY(-2px);
        }

        .admin-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .nav-btn {
            background: var(--card);
            color: var(--text);
            border: 1px solid var(--border);
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .nav-btn:hover {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
        }

        .admin-section {
            background: var(--card);
            padding: 30px;
            border-radius: 16px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
            display: none;
        }

        .admin-section.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .section-header h2 {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .action-btn {
            background: var(--accent);
            color: var(--bg);
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(93, 208, 255, 0.3);
        }

        /* Form Styles */
        .form-container {
            display: grid;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-label {
            font-weight: 600;
            color: var(--text);
            font-size: 14px;
            margin-bottom: 6px;
        }

        .form-input {
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-size: 14px;
            background: var(--bg);
            color: var(--text);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(93, 208, 255, 0.1);
        }

        .form-input::placeholder {
            color: var(--muted);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-select {
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-size: 14px;
            background: var(--bg);
            color: var(--text);
            font-family: inherit;
        }

        .form-checkbox {
            width: 20px;
            height: 20px;
            accent-color: var(--accent);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tag-input {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 12px;
            min-height: 50px;
            align-items: center;
            background: var(--bg);
        }

        .tag {
            background: var(--accent);
            color: var(--bg);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tag-remove {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            font-size: 14px;
            padding: 0;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s ease;
        }

        .tag-remove:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .tag-add-input {
            border: none;
            outline: none;
            padding: 4px;
            flex: 1;
            min-width: 100px;
            background: transparent;
            color: var(--text);
            font-family: inherit;
        }

        .tag-add-input::placeholder {
            color: var(--muted);
        }

        .items-list {
            border: 1px solid var(--border);
            border-radius: 12px;
            max-height: 400px;
            overflow-y: auto;
            background: var(--bg);
        }

        .item-card {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s ease;
        }

        .item-card:hover {
            background: var(--card);
        }

        .item-card:last-child {
            border-bottom: none;
        }

        .item-info h4 {
            color: var(--accent);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .item-info p {
            color: var(--muted);
            font-size: 14px;
        }

        .item-actions {
            display: flex;
            gap: 10px;
        }

        .btn-edit {
            background: var(--warning);
            color: var(--bg);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .btn-edit:hover {
            transform: translateY(-1px);
            opacity: 0.9;
        }

        .btn-delete {
            background: var(--error);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .btn-delete:hover {
            transform: translateY(-1px);
            opacity: 0.9;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            flex-wrap: wrap;
        }

        .btn-save {
            background: var(--success);
            color: var(--bg);
        }

        .btn-cancel {
            background: var(--muted);
            color: var(--bg);
        }

        .btn-preview {
            background: var(--accent);
            color: var(--bg);
        }

        .btn-group .action-btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-group .action-btn:hover {
            transform: translateY(-2px);
        }

        .status-message {
            padding: 12px 16px;
            border-radius: 12px;
            margin-top: 15px;
            font-weight: 500;
            border: 1px solid;
        }

        .status-success {
            background: rgba(143, 240, 167, 0.1);
            color: var(--success);
            border-color: var(--success);
        }

        .status-error {
            background: rgba(255, 107, 107, 0.1);
            color: var(--error);
            border-color: var(--error);
        }

        .status-info {
            background: rgba(93, 208, 255, 0.1);
            color: var(--accent);
            border-color: var(--accent);
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .form-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(11, 13, 19, 0.8);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--card);
            border: 1px solid var(--border);
            padding: 30px;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .modal-header h3 {
            color: var(--text);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: var(--bg);
            border: 1px solid var(--border);
            color: var(--text);
            font-size: 18px;
            cursor: pointer;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: var(--error);
            color: white;
            border-color: var(--error);
        }

        /* Image Upload Styles */
        .image-upload-container {
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            background: var(--bg);
        }

        .image-input-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .image-option {
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
        }

        .image-option .form-label {
            font-weight: 600;
            color: #007acc;
            margin-bottom: 8px;
        }

        .form-hint {
            display: block;
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }

        .image-preview {
            width: 100%;
            min-height: 200px;
            border: 2px dashed var(--border);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg);
            position: relative;
            overflow: hidden;
        }

        .preview-placeholder {
            color: var(--muted);
            font-size: 14px;
            text-align: center;
        }

        .preview-image {
            max-width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: 8px;
        }

        .preview-info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            right: 10px;
            background: rgba(11, 13, 19, 0.8);
            color: var(--text);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            backdrop-filter: blur(4px);
        }

        .image-actions {
            display: flex;
            gap: 10px;
            margin-top: 12px;
        }

        .btn-clear-image {
            background: var(--error);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .btn-clear-image:hover {
            transform: translateY(-1px);
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 15px;
            }

            .admin-header {
                padding: 20px;
                text-align: center;
            }

            .admin-header h1 {
                font-size: 2rem;
            }

            .theme-toggle {
                top: 15px;
                left: 15px;
            }

            .admin-nav {
                flex-direction: column;
                gap: 8px;
            }

            .nav-btn {
                width: 100%;
                padding: 14px 20px;
            }

            .admin-section {
                padding: 20px;
            }

            .section-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .section-header h2 {
                font-size: 1.25rem;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn-group .action-btn {
                width: 100%;
                text-align: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                padding: 20px;
            }

            .image-input-options {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .image-preview {
                min-height: 150px;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <button id="themeToggle" class="theme-toggle" onclick="toggleTheme()">üåô</button>
            <h1>üöÄ Admin Panel - Mathew Yel Website</h1>
            <p>Manage your website content with easy-to-use forms</p>
        </div>

        <div class="admin-nav">
            <button class="nav-btn active" onclick="showSection('projects')">Projects</button>
            <button class="nav-btn" onclick="showSection('blogs')">Blogs</button>
            <button class="nav-btn" onclick="showSection('gallery')">Gallery</button>
            <button class="nav-btn" onclick="showSection('awards')">Awards</button>
            <button class="nav-btn" onclick="showSection('social')">Social Media</button>
            <button class="nav-btn" onclick="showSection('personal')">Personal Info</button>
        </div>

        <!-- Projects Section -->
        <div id="projects-section" class="admin-section active">
            <div class="section-header">
                <h2>üíº Projects Management</h2>
                <button class="action-btn" onclick="openProjectForm()">Add New Project</button>
            </div>
            <div id="projects-list" class="items-list">
                <!-- Projects will be loaded here -->
            </div>
        </div>

        <!-- Blogs Section -->
        <div id="blogs-section" class="admin-section">
            <div class="section-header">
                <h2>üìù Blog Management</h2>
                <button class="action-btn" onclick="openBlogForm()">Add New Post</button>
            </div>
            <div id="blogs-list" class="items-list">
                <!-- Blog posts will be loaded here -->
            </div>
        </div>

        <!-- Gallery Section -->
        <div id="gallery-section" class="admin-section">
            <div class="section-header">
                <h2>üì∏ Gallery Management</h2>
                <button class="action-btn" onclick="openGalleryForm()">Add New Photo</button>
            </div>
            <div id="gallery-list" class="items-list">
                <!-- Gallery items will be loaded here -->
            </div>
        </div>

        <!-- Awards Section -->
        <div id="awards-section" class="admin-section">
            <div class="section-header">
                <h2>üèÜ Awards & Recognition</h2>
                <button class="action-btn" onclick="openAwardForm()">Add New Award</button>
            </div>
            <div id="awards-list" class="items-list">
                <!-- Awards will be loaded here -->
            </div>
        </div>

        <!-- Social Media Section -->
        <div id="social-section" class="admin-section">
            <div class="section-header">
                <h2>üîó Social Media Links</h2>
            </div>
            <div class="form-container">
                <h3 style="color: #007acc; margin-bottom: 15px;">Social Media Profiles</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">LinkedIn URL</label>
                        <input type="url" id="social-linkedin" class="form-input" placeholder="https://linkedin.com/in/username">
                    </div>
                    <div class="form-group">
                        <label class="form-label">GitHub URL</label>
                        <input type="url" id="social-github" class="form-input" placeholder="https://github.com/username">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Twitter URL</label>
                        <input type="url" id="social-twitter" class="form-input" placeholder="https://twitter.com/username">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Instagram URL</label>
                        <input type="url" id="social-instagram" class="form-input" placeholder="https://instagram.com/username">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Facebook URL</label>
                        <input type="url" id="social-facebook" class="form-input" placeholder="https://facebook.com/username">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Dribbble URL</label>
                        <input type="url" id="social-dribbble" class="form-input" placeholder="https://dribbble.com/username">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Behance URL</label>
                        <input type="url" id="social-behance" class="form-input" placeholder="https://behance.net/username">
                    </div>
                    <div class="form-group">
                        <label class="form-label">YouTube URL</label>
                        <input type="url" id="social-youtube" class="form-input" placeholder="https://youtube.com/c/username">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">TikTok URL</label>
                        <input type="url" id="social-tiktok" class="form-input" placeholder="https://tiktok.com/@username">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Discord URL</label>
                        <input type="url" id="social-discord" class="form-input" placeholder="https://discord.gg/invite">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Personal Website URL</label>
                        <input type="url" id="social-website" class="form-input" placeholder="https://yourwebsite.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Portfolio URL</label>
                        <input type="url" id="social-portfolio" class="form-input" placeholder="https://yourportfolio.com">
                    </div>
                </div>
                
                <h3 style="color: #007acc; margin: 25px 0 15px 0;">Contact Information</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Primary Email</label>
                        <input type="email" id="social-email" class="form-input" placeholder="your.email@example.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone Number</label>
                        <input type="tel" id="social-phone" class="form-input" placeholder="+1 (555) 123-4567">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">WhatsApp Number</label>
                        <input type="tel" id="social-whatsapp" class="form-input" placeholder="+1 (555) 123-4567">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Telegram Username</label>
                        <input type="text" id="social-telegram" class="form-input" placeholder="@username">
                    </div>
                </div>
                
                <h3 style="color: #007acc; margin: 25px 0 15px 0;">Business Information</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Business Address</label>
                        <textarea id="social-address" class="form-input form-textarea" placeholder="Your business address..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Business Hours</label>
                        <textarea id="social-hours" class="form-input form-textarea" placeholder="Monday - Friday: 9AM - 6PM..."></textarea>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="action-btn btn-save" onclick="saveSocialMedia()">Save Social Links</button>
                    <button class="action-btn btn-preview" onclick="previewSocialMedia()">Preview</button>
                </div>
            </div>
        </div>

        <!-- Personal Info Section -->
        <div id="personal-section" class="admin-section">
            <div class="section-header">
                <h2>üë§ Personal Information</h2>
            </div>
            <div class="form-container">
                <h3 style="color: #007acc; margin-bottom: 15px;">Hero Section</h3>
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" id="personal-name" class="form-input" placeholder="Your full name">
                </div>
                <div class="form-group">
                    <label class="form-label">Professional Title</label>
                    <input type="text" id="personal-title" class="form-input" placeholder="Your professional title">
                </div>
                <div class="form-group">
                    <label class="form-label">Hero Description</label>
                    <textarea id="personal-description" class="form-input form-textarea" placeholder="Main description for your hero section..."></textarea>
                </div>
                
                <h3 style="color: #007acc; margin: 25px 0 15px 0;">About Section</h3>
                <div class="form-group">
                    <label class="form-label">About Content (Paragraph 1)</label>
                    <textarea id="personal-about-1" class="form-input form-textarea" placeholder="First paragraph of your about section..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">About Content (Paragraph 2)</label>
                    <textarea id="personal-about-2" class="form-input form-textarea" placeholder="Second paragraph of your about section..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">About Content (Paragraph 3)</label>
                    <textarea id="personal-about-3" class="form-input form-textarea" placeholder="Third paragraph of your about section..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">About Content (Paragraph 4)</label>
                    <textarea id="personal-about-4" class="form-input form-textarea" placeholder="Fourth paragraph of your about section..."></textarea>
                </div>
                
                <h3 style="color: #007acc; margin: 25px 0 15px 0;">Contact Information</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" id="personal-email" class="form-input" placeholder="your.email@example.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Location</label>
                        <input type="text" id="personal-location" class="form-input" placeholder="Your location">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">University</label>
                        <input type="text" id="personal-university" class="form-input" placeholder="Your university">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Languages</label>
                        <input type="text" id="personal-languages" class="form-input" placeholder="Languages you speak">
                    </div>
                </div>
                
                <h3 style="color: #007acc; margin: 25px 0 15px 0;">Social Links</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">LinkedIn URL</label>
                        <input type="url" id="personal-linkedin" class="form-input" placeholder="https://linkedin.com/in/your-profile">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Portfolio Website</label>
                        <input type="url" id="personal-portfolio" class="form-input" placeholder="https://yourportfolio.com">
                    </div>
                </div>
                
                <h3 style="color: #007acc; margin: 25px 0 15px 0;">Skills At A Glance</h3>
                <div class="form-group">
                    <label class="form-label">Skills (one per line)</label>
                    <textarea id="personal-skills" class="form-input form-textarea" placeholder="Enter each skill on a new line...&#10;Brand Identity & Visual Design&#10;Web Development & UI/UX&#10;SEO & Programming"></textarea>
                </div>
                
                <h3 style="color: #007acc; margin: 25px 0 15px 0;">Highlights</h3>
                <div class="form-group">
                    <label class="form-label">Career Highlights (one per line)</label>
                    <textarea id="personal-highlights" class="form-input form-textarea" placeholder="Enter each highlight on a new line...&#10;Founder & Creative Director ‚Äî Yelose Graphics&#10;Founder ‚Äî VikraHub (Creative Platform)"></textarea>
                </div>
                
                <div class="btn-group">
                    <button class="action-btn btn-save" onclick="savePersonalInfo()">Save Changes</button>
                    <button class="action-btn btn-preview" onclick="previewPersonalInfo()">Preview</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Form Modal -->
    <div id="project-modal" class="form-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add/Edit Project</h3>
                <button class="modal-close" onclick="closeModal('project-modal')">&times;</button>
            </div>
            <div class="form-container">
                <div class="form-group">
                    <label class="form-label">Project Title</label>
                    <input type="text" id="project-title" class="form-input" placeholder="Enter project title">
                </div>
                <div class="form-group">
                    <label class="form-label">Summary</label>
                    <input type="text" id="project-summary" class="form-input" placeholder="Brief project description">
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="project-description" class="form-input form-textarea" placeholder="Detailed project description"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select id="project-status" class="form-select">
                            <option value="completed">Completed</option>
                            <option value="in-progress">In Progress</option>
                            <option value="planned">Planned</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Role</label>
                        <input type="text" id="project-role" class="form-input" placeholder="Your role in the project">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Start Date</label>
                        <input type="date" id="project-start-date" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Date</label>
                        <input type="date" id="project-end-date" class="form-input">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Project Link</label>
                        <input type="url" id="project-link" class="form-input" placeholder="https://project-link.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Featured Project</label>
                        <div class="checkbox-group">
                            <input type="checkbox" id="project-featured" class="form-checkbox">
                            <label for="project-featured" class="form-label">Mark as featured</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Project Image</label>
                    <div class="image-upload-container">
                        <div class="image-input-options">
                            <div class="image-option">
                                <label class="form-label">Option 1: Upload to Cloudinary (Recommended)</label>
                                <button type="button" class="action-btn" onclick="openCloudinaryWidget('projects', 'project-image')" style="margin-bottom: 10px;">
                                    <i class="fas fa-cloud-upload-alt"></i> Upload to Cloudinary
                                </button>
                                <small class="form-hint">Upload images up to 10MB with automatic optimization</small>
                            </div>
                            <div class="image-option">
                                <label class="form-label">Option 2: Use Existing URL</label>
                                <input type="url" id="project-image" class="form-input" placeholder="Cloudinary URL or external image URL" onchange="previewImageURL('project')">
                                <small class="form-hint">Paste image URL from Cloudinary or external source</small>
                            </div>
                            <div class="image-option" style="margin-top: 10px;">
                                <label class="form-label">Option 3: Upload Small Image (Base64)</label>
                                <input type="file" id="project-image-file" class="form-input" accept="image/*" onchange="handleImageUpload('project')">
                                <small class="form-hint">Only for small images < 100KB (will be compressed)</small>
                            </div>
                        </div>
                        <div class="image-preview" id="project-image-preview">
                            <div class="preview-placeholder">No image selected</div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Technologies</label>
                    <div id="project-tech-tags" class="tag-input">
                        <input type="text" class="tag-add-input" placeholder="Add technology and press Enter">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Technologies</label>
                    <div id="project-tech-tags" class="tag-input">
                        <input type="text" class="tag-add-input" placeholder="Add technology and press Enter">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Tags</label>
                    <div id="project-tags" class="tag-input">
                        <input type="text" class="tag-add-input" placeholder="Add tag and press Enter">
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="project-featured" class="form-checkbox">
                        <label for="project-featured" class="form-label">Featured Project</label>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="action-btn btn-save" onclick="saveProject()">Save Project</button>
                    <button class="action-btn btn-cancel" onclick="closeModal('project-modal')">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Gallery Form Modal -->
    <div id="gallery-modal" class="form-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add/Edit Photo</h3>
                <button class="modal-close" onclick="closeModal('gallery-modal')">&times;</button>
            </div>
            <div class="form-container">
                <div class="form-group">
                    <label class="form-label">Photo Title</label>
                    <input type="text" id="gallery-title" class="form-input" placeholder="Enter photo title">
                </div>
                <div class="form-group">
                    <label class="form-label">Image URL</label>
                    <input type="url" id="gallery-src" class="form-input" placeholder="/assets/gallery/photo.jpg">
                </div>
                <div class="form-group">
                    <label class="form-label">Alt Text</label>
                    <input type="text" id="gallery-alt" class="form-input" placeholder="Description for accessibility">
                </div>
                <div class="form-group">
                    <label class="form-label">Caption</label>
                    <textarea id="gallery-caption" class="form-input form-textarea" placeholder="Photo caption"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select id="gallery-category" class="form-select">
                            <option value="professional">Professional</option>
                            <option value="personal">Personal</option>
                            <option value="events">Events</option>
                            <option value="projects">Projects</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Display Order</label>
                        <input type="number" id="gallery-order" class="form-input" placeholder="1" min="1">
                    </div>
                </div>
                <div class="btn-group">
                    <button class="action-btn btn-save" onclick="saveGalleryItem()">Save Photo</button>
                    <button class="action-btn btn-cancel" onclick="closeModal('gallery-modal')">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Award Form Modal -->
    <div id="award-modal" class="form-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add/Edit Award</h3>
                <button class="modal-close" onclick="closeModal('award-modal')">&times;</button>
            </div>
            <div class="form-container">
                <div class="form-group">
                    <label class="form-label">Award Title</label>
                    <input type="text" id="award-title" class="form-input" placeholder="Enter award title">
                </div>
                <div class="form-group">
                    <label class="form-label">Organization</label>
                    <input type="text" id="award-organization" class="form-input" placeholder="Awarding organization">
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="award-description" class="form-input form-textarea" placeholder="Award description"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Date</label>
                        <input type="date" id="award-date" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select id="award-category" class="form-select">
                            <option value="academic">Academic</option>
                            <option value="professional">Professional</option>
                            <option value="innovation">Innovation</option>
                            <option value="leadership">Leadership</option>
                            <option value="community">Community</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="award-featured" class="form-checkbox">
                        <label for="award-featured" class="form-label">Featured Award</label>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="action-btn btn-save" onclick="saveAward()">Save Award</button>
                    <button class="action-btn btn-cancel" onclick="closeModal('award-modal')">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Blog Form Modal -->
    <div id="blog-modal" class="form-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add/Edit Blog Post</h3>
                <button class="modal-close" onclick="closeModal('blog-modal')">&times;</button>
            </div>
            <div class="form-container">
                <div class="form-group">
                    <label class="form-label">Post Title</label>
                    <input type="text" id="blog-title" class="form-input" placeholder="Enter blog post title">
                </div>
                <div class="form-group">
                    <label class="form-label">Slug (URL)</label>
                    <input type="text" id="blog-slug" class="form-input" placeholder="url-friendly-slug">
                    <small class="form-hint">Auto-generated from title if left empty</small>
                </div>
                <div class="form-group">
                    <label class="form-label">Excerpt/Summary</label>
                    <textarea id="blog-excerpt" class="form-input form-textarea" placeholder="Brief description of the blog post for listings..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Content</label>
                    <textarea id="blog-content" class="form-input form-textarea" style="min-height: 200px;" placeholder="Full blog post content (supports Markdown)..."></textarea>
                    <small class="form-hint">You can use Markdown formatting for better content structure</small>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select id="blog-category" class="form-select">
                            <option value="design">Design</option>
                            <option value="development">Development</option>
                            <option value="business">Business</option>
                            <option value="technology">Technology</option>
                            <option value="personal">Personal</option>
                            <option value="tutorial">Tutorial</option>
                            <option value="insights">Insights</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select id="blog-status" class="form-select">
                            <option value="draft">Draft</option>
                            <option value="published">Published</option>
                            <option value="scheduled">Scheduled</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Publish Date</label>
                        <input type="date" id="blog-date" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Reading Time (minutes)</label>
                        <input type="number" id="blog-reading-time" class="form-input" placeholder="5" min="1" max="60">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Featured Image</label>
                    <div class="image-upload-container">
                        <div class="image-input-options">
                            <div class="image-option">
                                <label class="form-label">Option 1: Upload to Cloudinary (Recommended)</label>
                                <button type="button" class="action-btn" onclick="openCloudinaryWidget('blogs', 'blog-image')" style="margin-bottom: 10px;">
                                    <i class="fas fa-cloud-upload-alt"></i> Upload to Cloudinary
                                </button>
                                <small class="form-hint">Upload images up to 10MB with automatic optimization</small>
                            </div>
                            <div class="image-option">
                                <label class="form-label">Option 2: Use Existing URL</label>
                                <input type="url" id="blog-image" class="form-input" placeholder="Cloudinary URL or external image URL" onchange="previewImageURL('blog')">
                                <small class="form-hint">Paste image URL from Cloudinary or external source</small>
                            </div>
                            <div class="image-option" style="margin-top: 10px;">
                                <label class="form-label">Option 3: Upload Small Image (Base64)</label>
                                <input type="file" id="blog-image-file" class="form-input" accept="image/*" onchange="handleImageUpload('blog')">
                                <small class="form-hint">Only for small images < 100KB (will be compressed)</small>
                            </div>
                        </div>
                        <div class="image-preview" id="blog-image-preview">
                            <div class="preview-placeholder">No image selected</div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Tags</label>
                    <div id="blog-tags" class="tag-input">
                        <input type="text" class="tag-add-input" placeholder="Add tag and press Enter">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Author</label>
                        <input type="text" id="blog-author" class="form-input" placeholder="Author name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">SEO Meta Description</label>
                        <input type="text" id="blog-meta" class="form-input" placeholder="SEO description for search engines">
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="blog-featured" class="form-checkbox">
                        <label for="blog-featured" class="form-label">Featured Post</label>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="action-btn btn-save" onclick="saveBlog()">Save Post</button>
                    <button class="action-btn btn-preview" onclick="previewBlog()">Preview</button>
                    <button class="action-btn btn-cancel" onclick="closeModal('blog-modal')">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div id="status-messages" style="position: fixed; top: 20px; right: 20px; z-index: 2000;"></div>

    <script>
        // Cloudinary Configuration - will be loaded from server
        let CLOUDINARY_CONFIG = {
            cloudName: null,
            uploadPreset: null,
            configured: false
        };

        // Load Cloudinary configuration from server
        async function loadCloudinaryConfig() {
            try {
                const response = await fetch('/api/cloudinary/config');
                const config = await response.json();
                
                if (config.configured) {
                    CLOUDINARY_CONFIG.cloudName = config.cloudName;
                    CLOUDINARY_CONFIG.uploadPreset = config.uploadPreset;
                    CLOUDINARY_CONFIG.configured = true;
                    console.log('‚úì Cloudinary configured successfully');
                } else {
                    console.warn('‚ö†Ô∏è Cloudinary not configured on server');
                    showStatus('Cloudinary upload not available. Please configure environment variables.', 'warning');
                }
            } catch (error) {
                console.error('Failed to load Cloudinary config:', error);
                showStatus('Failed to load Cloudinary configuration', 'error');
            }
        }

        // Open Cloudinary Upload Widget
        function openCloudinaryWidget(section, targetInputId) {
            // Check if Cloudinary is configured
            if (!CLOUDINARY_CONFIG.configured || !CLOUDINARY_CONFIG.cloudName) {
                showStatus('Cloudinary is not configured. Please set CLOUDINARY_CLOUD_NAME in environment variables.', 'error');
                return;
            }

            const widget = cloudinary.createUploadWidget({
                cloudName: CLOUDINARY_CONFIG.cloudName,
                uploadPreset: CLOUDINARY_CONFIG.uploadPreset,
                sources: ['local', 'url', 'camera'],
                multiple: false,
                maxFileSize: 10000000, // 10MB
                maxImageWidth: 2000,
                maxImageHeight: 2000,
                cropping: true,
                croppingAspectRatio: 1.5,
                folder: `mathew-yel/${section}`,
                resourceType: 'auto',
                clientAllowedFormats: ['jpg', 'jpeg', 'png', 'gif', 'webp', 'svg', 'mp4', 'mov'],
                styles: {
                    palette: {
                        window: '#121521',
                        windowBorder: '#5dd0ff',
                        tabIcon: '#5dd0ff',
                        menuIcons: '#f2f4f8',
                        textDark: '#0b1020',
                        textLight: '#f2f4f8',
                        link: '#5dd0ff',
                        action: '#5dd0ff',
                        inactiveTabIcon: '#a7b0c0',
                        error: '#ff6b6b',
                        inProgress: '#ffb366',
                        complete: '#8ff0a7',
                        sourceBg: '#0b0d13'
                    },
                    fonts: {
                        default: null,
                        'sans-serif': {
                            url: null,
                            active: true
                        }
                    }
                }
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    const imageUrl = result.info.secure_url;
                    
                    // Set URL in input field
                    document.getElementById(targetInputId).value = imageUrl;
                    
                    // Show preview
                    previewImageURL(section);
                    
                    // Show success message with file info
                    const sizeKB = (result.info.bytes / 1024).toFixed(1);
                    showStatus(`‚úì Uploaded: ${result.info.original_filename} (${sizeKB}KB)`, 'success');
                    
                    console.log('Cloudinary upload success:', result.info);
                }
                
                if (error) {
                    console.error('Cloudinary upload error:', error);
                    showStatus('Upload failed. Please try again.', 'error');
                }
            });
            
            widget.open();
        }

        // Global variables
        let currentData = {
            projects: [],
            blogs: [],
            gallery: [],
            awards: [],
            personal: {},
            social: {}
        };
        let editingIndex = -1;
        let editingSection = '';

        // Theme Management
        function initTheme() {
            const savedTheme = localStorage.getItem('admin-theme') || 'dark';
            const root = document.documentElement;
            const themeToggle = document.getElementById('themeToggle');
            
            if (savedTheme === 'light') {
                root.classList.add('light');
                themeToggle.textContent = '‚òÄÔ∏è';
            } else {
                root.classList.remove('light');
                themeToggle.textContent = 'üåô';
            }
        }

        function toggleTheme() {
            const root = document.documentElement;
            const themeToggle = document.getElementById('themeToggle');
            const isLight = root.classList.toggle('light');
            
            if (isLight) {
                themeToggle.textContent = '‚òÄÔ∏è';
                localStorage.setItem('admin-theme', 'light');
            } else {
                themeToggle.textContent = 'üåô';
                localStorage.setItem('admin-theme', 'dark');
            }
        }

        // Initialize admin panel
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            loadCloudinaryConfig(); // Load Cloudinary configuration
            loadAllData();
        });

        // Navigation functions
        function showSection(section) {
            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Show section
            document.querySelectorAll('.admin-section').forEach(sec => sec.classList.remove('active'));
            document.getElementById(section + '-section').classList.add('active');

            // Load section data
            loadSectionData(section);
        }

        // Load all data from JSON files
        async function loadAllData() {
            const dataFiles = {
                projects: '/data/projects.json',
                blogs: '/data/posts.json',
                gallery: '/data/gallery.json',
                awards: '/data/awards.json',
                personal: '/data/personal.json',
                social: '/data/social.json'
            };

            for (const [key, url] of Object.entries(dataFiles)) {
                try {
                    // Try API endpoint first (for production), fallback to direct file access (for development)
                    let response;
                    if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
                        // Production: use API
                        response = await fetch(`/api/data/${key}`);
                    } else {
                        // Development: direct file access
                        response = await fetch(url);
                    }
                    
                    if (response.ok) {
                        currentData[key] = await response.json();
                    }
                } catch (error) {
                    console.error(`Error loading ${key}:`, error);
                    showStatus(`Failed to load ${key} data`, 'error');
                }
            }

            // Load initial section
            loadSectionData('projects');
            loadPersonalInfo();
            loadSocialMedia();
        }

        // Load section data into lists
        function loadSectionData(section) {
            switch (section) {
                case 'projects':
                    loadProjectsList();
                    break;
                case 'blogs':
                    loadBlogsList();
                    break;
                case 'gallery':
                    loadGalleryList();
                    break;
                case 'awards':
                    loadAwardsList();
                    break;
                case 'social':
                    loadSocialMedia();
                    break;
                case 'personal':
                    loadPersonalInfo();
                    break;
            }
        }

        // Projects functions
        function loadProjectsList() {
            const container = document.getElementById('projects-list');
            
            // Handle the actual structure where projects are in currentData.projects.items
            const projectsArray = currentData.projects?.items || currentData.projects || [];
            
            if (!projectsArray || projectsArray.length === 0) {
                container.innerHTML = '<div class="item-card"><p>No projects found. Add your first project!</p></div>';
                return;
            }

            container.innerHTML = projectsArray.map((project, index) => `
                <div class="item-card">
                    <div class="item-info">
                        ${project.image ? `<div class="item-image"><img src="${project.image}" alt="${project.title}" style="width: 60px; height: 40px; object-fit: cover; border-radius: 4px; margin-right: 10px; float: left;"></div>` : ''}
                        <h4>${project.title}</h4>
                        <p>${project.summary}</p>
                        <p><strong>Status:</strong> ${project.status || 'completed'} | <strong>Role:</strong> ${project.role || 'N/A'}</p>
                        ${project.image ? `<div style="clear: both;"></div>` : ''}
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editProject(${index})">Edit</button>
                        <button class="btn-delete" onclick="deleteProject(${index})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function openProjectForm() {
            editingIndex = -1;
            editingSection = 'projects';
            clearProjectForm();
            document.getElementById('project-modal').style.display = 'flex';
        }

        function editProject(index) {
            editingIndex = index;
            editingSection = 'projects';
            
            // Handle the actual structure where projects are in currentData.projects.items
            const projectsArray = currentData.projects?.items || currentData.projects || [];
            const project = projectsArray[index];
            
            document.getElementById('project-title').value = project.title || '';
            document.getElementById('project-summary').value = project.summary || '';
            document.getElementById('project-description').value = project.description || '';
            document.getElementById('project-status').value = project.status || 'completed';
            document.getElementById('project-role').value = project.role || '';
            document.getElementById('project-start-date').value = project.startDate || '';
            document.getElementById('project-end-date').value = project.endDate || '';
            document.getElementById('project-link').value = project.link || '';
            document.getElementById('project-image').value = project.image || '';
            document.getElementById('project-featured').checked = project.featured || false;

            // Load image preview if exists
            if (project.image) {
                previewImageURL('project');
            } else {
                clearImagePreview('project');
            }

            // Load tech tags
            const techContainer = document.getElementById('project-tech-tags');
            if (techContainer) {
                techContainer.innerHTML = '<input type="text" class="tag-add-input" placeholder="Add technology and press Enter">';
                if (project.tech) {
                    project.tech.forEach(tech => addTag('project-tech-tags', tech));
                }
            }

            // Load tags
            const tagsContainer = document.getElementById('project-tags');
            if (tagsContainer) {
                tagsContainer.innerHTML = '<input type="text" class="tag-add-input" placeholder="Add tag and press Enter">';
                if (project.tags) {
                    project.tags.forEach(tag => addTag('project-tags', tag));
                }
            }

            document.getElementById('project-modal').style.display = 'flex';
        }

        function clearProjectForm() {
            document.getElementById('project-title').value = '';
            document.getElementById('project-summary').value = '';
            document.getElementById('project-description').value = '';
            document.getElementById('project-status').value = 'completed';
            document.getElementById('project-role').value = '';
            document.getElementById('project-start-date').value = '';
            document.getElementById('project-end-date').value = '';
            document.getElementById('project-link').value = '';
            document.getElementById('project-image').value = '';
            document.getElementById('project-featured').checked = false;

            // Clear image preview and file input
            document.getElementById('project-image-file').value = '';
            clearImagePreview('project');

            // Clear tags
            const techTagsEl = document.getElementById('project-tech-tags');
            const regularTagsEl = document.getElementById('project-tags');
            if (techTagsEl) {
                techTagsEl.innerHTML = '<input type="text" class="tag-add-input" placeholder="Add technology and press Enter">';
            }
            if (regularTagsEl) {
                regularTagsEl.innerHTML = '<input type="text" class="tag-add-input" placeholder="Add tag and press Enter">';
            }
        }

        async function saveProject() {
            const project = {
                id: editingIndex === -1 ? generateId() : (currentData.projects?.items || currentData.projects || [])[editingIndex].id,
                title: document.getElementById('project-title').value,
                summary: document.getElementById('project-summary').value,
                description: document.getElementById('project-description').value,
                status: document.getElementById('project-status').value,
                role: document.getElementById('project-role').value,
                startDate: document.getElementById('project-start-date').value,
                endDate: document.getElementById('project-end-date').value,
                link: document.getElementById('project-link').value,
                image: document.getElementById('project-image').value,
                featured: document.getElementById('project-featured').checked,
                tech: getTags('project-tech-tags'),
                tags: getTags('project-tags')
            };

            // Handle the actual structure
            if (!currentData.projects.items) {
                // If it's a simple array
                if (editingIndex === -1) {
                    currentData.projects.push(project);
                } else {
                    currentData.projects[editingIndex] = project;
                }
            } else {
                // If it has the items structure
                if (editingIndex === -1) {
                    currentData.projects.items.push(project);
                } else {
                    currentData.projects.items[editingIndex] = project;
                }
            }

            closeModal('project-modal');
            loadProjectsList();
            showStatus('Project saved successfully!', 'success');
            await saveDataToAPI('projects');
        }

        async function deleteProject(index) {
            if (confirm('Are you sure you want to delete this project?')) {
                // Handle the actual structure
                if (!currentData.projects.items) {
                    currentData.projects.splice(index, 1);
                } else {
                    currentData.projects.items.splice(index, 1);
                }
                loadProjectsList();
                showStatus('Project deleted successfully!', 'success');
                await saveDataToAPI('projects');
            }
        }

        // Gallery functions
        function loadGalleryList() {
            const container = document.getElementById('gallery-list');
            
            // Handle the actual structure where gallery items are in currentData.gallery.items
            const galleryArray = currentData.gallery?.items || currentData.gallery || [];
            
            if (!galleryArray || galleryArray.length === 0) {
                container.innerHTML = '<div class="item-card"><p>No photos found. Add your first photo!</p></div>';
                return;
            }

            container.innerHTML = galleryArray.map((item, index) => `
                <div class="item-card">
                    <div class="item-info">
                        <h4>${item.title}</h4>
                        <p>${item.description || item.caption}</p>
                        <p><strong>Category:</strong> ${item.category || 'N/A'} | <strong>Order:</strong> ${item.order || 'N/A'}</p>
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editGalleryItem(${index})">Edit</button>
                        <button class="btn-delete" onclick="deleteGalleryItem(${index})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function openGalleryForm() {
            editingIndex = -1;
            editingSection = 'gallery';
            clearGalleryForm();
            document.getElementById('gallery-modal').style.display = 'flex';
        }

        function editGalleryItem(index) {
            editingIndex = index;
            editingSection = 'gallery';
            
            // Handle the actual structure where gallery items are in currentData.gallery.items
            const galleryArray = currentData.gallery?.items || currentData.gallery || [];
            const item = galleryArray[index];
            
            document.getElementById('gallery-title').value = item.title || '';
            document.getElementById('gallery-src').value = item.image || item.src || '';
            document.getElementById('gallery-alt').value = item.alt || '';
            document.getElementById('gallery-caption').value = item.description || item.caption || '';
            document.getElementById('gallery-category').value = item.category || 'professional';
            document.getElementById('gallery-order').value = item.order || 1;

            document.getElementById('gallery-modal').style.display = 'flex';
        }

        function clearGalleryForm() {
            document.getElementById('gallery-title').value = '';
            document.getElementById('gallery-src').value = '';
            document.getElementById('gallery-alt').value = '';
            document.getElementById('gallery-caption').value = '';
            document.getElementById('gallery-category').value = 'professional';
            document.getElementById('gallery-order').value = '';
        }

        async function saveGalleryItem() {
            const item = {
                id: editingIndex === -1 ? generateId() : (currentData.gallery?.items || currentData.gallery || [])[editingIndex].id,
                title: document.getElementById('gallery-title').value,
                image: document.getElementById('gallery-src').value,
                src: document.getElementById('gallery-src').value, // For backward compatibility
                alt: document.getElementById('gallery-alt').value,
                description: document.getElementById('gallery-caption').value,
                caption: document.getElementById('gallery-caption').value, // For backward compatibility
                category: document.getElementById('gallery-category').value,
                order: parseInt(document.getElementById('gallery-order').value) || 1
            };

            // Handle the actual structure
            if (!currentData.gallery.items) {
                // If it's a simple array
                if (editingIndex === -1) {
                    currentData.gallery.push(item);
                } else {
                    currentData.gallery[editingIndex] = item;
                }
            } else {
                // If it has the items structure
                if (editingIndex === -1) {
                    currentData.gallery.items.push(item);
                } else {
                    currentData.gallery.items[editingIndex] = item;
                }
            }

            closeModal('gallery-modal');
            loadGalleryList();
            showStatus('Photo saved successfully!', 'success');
            await saveDataToAPI('gallery');
        }

        async function deleteGalleryItem(index) {
            if (confirm('Are you sure you want to delete this photo?')) {
                // Handle the actual structure
                if (!currentData.gallery.items) {
                    currentData.gallery.splice(index, 1);
                } else {
                    currentData.gallery.items.splice(index, 1);
                }
                loadGalleryList();
                showStatus('Photo deleted successfully!', 'success');
                await saveDataToAPI('gallery');
            }
        }

        // Awards functions
        function loadAwardsList() {
            const container = document.getElementById('awards-list');
            
            // Handle the actual structure where awards are in currentData.awards.items
            const awardsArray = currentData.awards?.items || currentData.awards || [];
            
            if (!awardsArray || awardsArray.length === 0) {
                container.innerHTML = '<div class="item-card"><p>No awards found. Add your first award!</p></div>';
                return;
            }

            container.innerHTML = awardsArray.map((award, index) => `
                <div class="item-card">
                    <div class="item-info">
                        <h4>${award.title}</h4>
                        <p>${award.description}</p>
                        <p><strong>Year:</strong> ${award.year || award.date || 'N/A'} | <strong>Category:</strong> ${award.category || 'N/A'}</p>
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editAward(${index})">Edit</button>
                        <button class="btn-delete" onclick="deleteAward(${index})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function openAwardForm() {
            editingIndex = -1;
            editingSection = 'awards';
            clearAwardForm();
            document.getElementById('award-modal').style.display = 'flex';
        }

        function editAward(index) {
            editingIndex = index;
            editingSection = 'awards';
            
            // Handle the actual structure where awards are in currentData.awards.items
            const awardsArray = currentData.awards?.items || currentData.awards || [];
            const award = awardsArray[index];
            
            document.getElementById('award-title').value = award.title || '';
            document.getElementById('award-organization').value = award.organization || '';
            document.getElementById('award-description').value = award.description || '';
            document.getElementById('award-date').value = award.date || award.year || '';
            document.getElementById('award-category').value = award.category || 'professional';
            document.getElementById('award-featured').checked = award.featured || false;

            document.getElementById('award-modal').style.display = 'flex';
        }

        function clearAwardForm() {
            document.getElementById('award-title').value = '';
            document.getElementById('award-organization').value = '';
            document.getElementById('award-description').value = '';
            document.getElementById('award-date').value = '';
            document.getElementById('award-category').value = 'professional';
            document.getElementById('award-featured').checked = false;
        }

        async function saveAward() {
            const award = {
                id: editingIndex === -1 ? generateId() : (currentData.awards?.items || currentData.awards || [])[editingIndex].id,
                title: document.getElementById('award-title').value,
                organization: document.getElementById('award-organization').value,
                description: document.getElementById('award-description').value,
                date: document.getElementById('award-date').value,
                year: document.getElementById('award-date').value, // For backward compatibility
                category: document.getElementById('award-category').value,
                featured: document.getElementById('award-featured').checked
            };

            // Handle the actual structure
            if (!currentData.awards.items) {
                // If it's a simple array
                if (editingIndex === -1) {
                    currentData.awards.push(award);
                } else {
                    currentData.awards[editingIndex] = award;
                }
            } else {
                // If it has the items structure
                if (editingIndex === -1) {
                    currentData.awards.items.push(award);
                } else {
                    currentData.awards.items[editingIndex] = award;
                }
            }

            closeModal('award-modal');
            loadAwardsList();
            showStatus('Award saved successfully!', 'success');
            await saveDataToAPI('awards');
        }

        async function deleteAward(index) {
            if (confirm('Are you sure you want to delete this award?')) {
                // Handle the actual structure
                if (!currentData.awards.items) {
                    currentData.awards.splice(index, 1);
                } else {
                    currentData.awards.items.splice(index, 1);
                }
                loadAwardsList();
                showStatus('Award deleted successfully!', 'success');
                await saveDataToAPI('awards');
            }
        }

        // Blog functions
        function loadBlogsList() {
            const container = document.getElementById('blogs-list');
            
            // Handle the actual structure where blogs are in currentData.blogs.items
            const blogsArray = currentData.blogs?.items || currentData.blogs || [];
            
            if (!blogsArray || blogsArray.length === 0) {
                container.innerHTML = '<div class="item-card"><p>No blog posts found. Add your first post!</p></div>';
                return;
            }

            container.innerHTML = blogsArray.map((blog, index) => `
                <div class="item-card">
                    <div class="item-info">
                        ${blog.image ? `<div class="item-image"><img src="${blog.image}" alt="${blog.title}" style="width: 60px; height: 40px; object-fit: cover; border-radius: 4px; margin-right: 10px; float: left;"></div>` : ''}
                        <h4>${blog.title}</h4>
                        <p>${blog.excerpt}</p>
                        <p><strong>Status:</strong> ${blog.status || 'draft'} | <strong>Category:</strong> ${blog.category || 'general'} | <strong>Date:</strong> ${blog.date || 'N/A'}</p>
                        ${blog.image ? `<div style="clear: both;"></div>` : ''}
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editBlog(${index})">Edit</button>
                        <button class="btn-delete" onclick="deleteBlog(${index})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function openBlogForm() {
            editingIndex = -1;
            editingSection = 'blogs';
            clearBlogForm();
            // Set default date to today
            document.getElementById('blog-date').value = new Date().toISOString().split('T')[0];
            document.getElementById('blog-modal').style.display = 'flex';
        }

        function editBlog(index) {
            editingIndex = index;
            editingSection = 'blogs';
            
            // Handle the actual structure where blogs are in currentData.blogs.items
            const blogsArray = currentData.blogs?.items || currentData.blogs || [];
            const blog = blogsArray[index];
            
            document.getElementById('blog-title').value = blog.title || '';
            document.getElementById('blog-slug').value = blog.slug || '';
            document.getElementById('blog-excerpt').value = blog.excerpt || '';
            document.getElementById('blog-content').value = blog.content || '';
            document.getElementById('blog-category').value = blog.category || 'design';
            document.getElementById('blog-status').value = blog.status || 'draft';
            document.getElementById('blog-date').value = blog.date || '';
            document.getElementById('blog-reading-time').value = blog.readingTime || '';
            document.getElementById('blog-image').value = blog.image || '';
            document.getElementById('blog-author').value = blog.author || '';
            document.getElementById('blog-meta').value = blog.metaDescription || '';
            document.getElementById('blog-featured').checked = blog.featured || false;

            // Load image preview if exists
            if (blog.image) {
                previewImageURL('blog');
            } else {
                clearImagePreview('blog');
            }

            // Load tags
            const tagsContainer = document.getElementById('blog-tags');
            if (tagsContainer) {
                tagsContainer.innerHTML = '<input type="text" class="tag-add-input" placeholder="Add tag and press Enter">';
                if (blog.tags) {
                    blog.tags.forEach(tag => addTag('blog-tags', tag));
                }
            }

            document.getElementById('blog-modal').style.display = 'flex';
        }

        function clearBlogForm() {
            document.getElementById('blog-title').value = '';
            document.getElementById('blog-slug').value = '';
            document.getElementById('blog-excerpt').value = '';
            document.getElementById('blog-content').value = '';
            document.getElementById('blog-category').value = 'design';
            document.getElementById('blog-status').value = 'draft';
            document.getElementById('blog-date').value = '';
            document.getElementById('blog-reading-time').value = '';
            document.getElementById('blog-image').value = '';
            document.getElementById('blog-author').value = '';
            document.getElementById('blog-meta').value = '';
            document.getElementById('blog-featured').checked = false;

            // Clear image preview and file input
            document.getElementById('blog-image-file').value = '';
            clearImagePreview('blog');

            // Clear tags
            const tagsEl = document.getElementById('blog-tags');
            if (tagsEl) {
                tagsEl.innerHTML = '<input type="text" class="tag-add-input" placeholder="Add tag and press Enter">';
            }
        }

        function generateSlug(title) {
            return title.toLowerCase()
                .replace(/[^a-z0-9 -]/g, '') // Remove special characters
                .replace(/\s+/g, '-') // Replace spaces with hyphens
                .replace(/-+/g, '-') // Replace multiple hyphens with single hyphen
                .trim('-'); // Remove leading/trailing hyphens
        }

        async function saveBlog() {
            const title = document.getElementById('blog-title').value;
            let slug = document.getElementById('blog-slug').value.trim();
            
            // Auto-generate slug if empty
            if (!slug && title) {
                slug = generateSlug(title);
                document.getElementById('blog-slug').value = slug;
            }

            const blog = {
                id: editingIndex === -1 ? generateId() : (currentData.blogs?.items || currentData.blogs || [])[editingIndex].id,
                title: title,
                slug: slug,
                excerpt: document.getElementById('blog-excerpt').value,
                content: document.getElementById('blog-content').value,
                category: document.getElementById('blog-category').value,
                status: document.getElementById('blog-status').value,
                date: document.getElementById('blog-date').value,
                readingTime: parseInt(document.getElementById('blog-reading-time').value) || 5,
                image: document.getElementById('blog-image').value,
                author: document.getElementById('blog-author').value || 'Mathew Yel',
                metaDescription: document.getElementById('blog-meta').value,
                featured: document.getElementById('blog-featured').checked,
                tags: getTags('blog-tags'),
                createdAt: editingIndex === -1 ? new Date().toISOString() : (currentData.blogs?.items || currentData.blogs || [])[editingIndex].createdAt,
                updatedAt: new Date().toISOString()
            };

            // Handle the actual structure
            if (!currentData.blogs) {
                currentData.blogs = { items: [] };
            }
            
            if (!currentData.blogs.items) {
                // If it's a simple array
                if (editingIndex === -1) {
                    currentData.blogs.push(blog);
                } else {
                    currentData.blogs[editingIndex] = blog;
                }
            } else {
                // If it has the items structure
                if (editingIndex === -1) {
                    currentData.blogs.items.push(blog);
                } else {
                    currentData.blogs.items[editingIndex] = blog;
                }
            }

            closeModal('blog-modal');
            loadBlogsList();
            showStatus('Blog post saved successfully!', 'success');
            await saveDataToAPI('blogs');
        }

        async function deleteBlog(index) {
            if (confirm('Are you sure you want to delete this blog post?')) {
                // Handle the actual structure
                if (!currentData.blogs.items) {
                    currentData.blogs.splice(index, 1);
                } else {
                    currentData.blogs.items.splice(index, 1);
                }
                loadBlogsList();
                showStatus('Blog post deleted successfully!', 'success');
                await saveDataToAPI('blogs');
            }
        }

        function previewBlog() {
            const blog = {
                title: document.getElementById('blog-title').value,
                slug: document.getElementById('blog-slug').value,
                excerpt: document.getElementById('blog-excerpt').value,
                content: document.getElementById('blog-content').value,
                category: document.getElementById('blog-category').value,
                status: document.getElementById('blog-status').value,
                date: document.getElementById('blog-date').value,
                readingTime: document.getElementById('blog-reading-time').value,
                image: document.getElementById('blog-image').value,
                author: document.getElementById('blog-author').value,
                tags: getTags('blog-tags')
            };

            console.log('Blog Preview:', blog);
            showStatus('Blog preview logged to console', 'info');
        }

        // Personal Info functions
        function loadPersonalInfo() {
            if (currentData.personal && currentData.personal.hero) {
                // Load hero section data
                document.getElementById('personal-name').value = currentData.personal.hero.name || '';
                document.getElementById('personal-title').value = currentData.personal.hero.title || '';
                document.getElementById('personal-description').value = currentData.personal.hero.description || '';
                
                // Load location from quickInfo
                if (currentData.personal.hero.quickInfo && currentData.personal.hero.quickInfo[0]) {
                    document.getElementById('personal-location').value = currentData.personal.hero.quickInfo[0].text || '';
                }
                
                // Load university from quickInfo
                if (currentData.personal.hero.quickInfo && currentData.personal.hero.quickInfo[1]) {
                    document.getElementById('personal-university').value = currentData.personal.hero.quickInfo[1].text || '';
                }
                
                // Load languages from quickInfo
                if (currentData.personal.hero.quickInfo && currentData.personal.hero.quickInfo[2]) {
                    document.getElementById('personal-languages').value = currentData.personal.hero.quickInfo[2].text || '';
                }
                
                // Load highlights
                if (currentData.personal.hero.highlights) {
                    document.getElementById('personal-highlights').value = currentData.personal.hero.highlights.join('\n');
                }
                
                // Load portfolio link
                if (currentData.personal.hero.links && currentData.personal.hero.links[0]) {
                    document.getElementById('personal-portfolio').value = currentData.personal.hero.links[0].url || '';
                }
                
                // Load LinkedIn link
                if (currentData.personal.hero.links && currentData.personal.hero.links[1]) {
                    document.getElementById('personal-linkedin').value = currentData.personal.hero.links[1].url || '';
                }
            }
            
            // Load about section
            if (currentData.personal && currentData.personal.about && currentData.personal.about.content) {
                document.getElementById('personal-about-1').value = currentData.personal.about.content[0] || '';
                document.getElementById('personal-about-2').value = currentData.personal.about.content[1] || '';
                document.getElementById('personal-about-3').value = currentData.personal.about.content[2] || '';
                document.getElementById('personal-about-4').value = currentData.personal.about.content[3] || '';
                
                // Load skills at a glance
                if (currentData.personal.about.atAGlance) {
                    document.getElementById('personal-skills').value = currentData.personal.about.atAGlance.join('\n');
                }
            }
            
            // Load contact info
            if (currentData.personal && currentData.personal.contact) {
                document.getElementById('personal-email').value = currentData.personal.contact.email || '';
                
                // Load LinkedIn from contact social
                if (currentData.personal.contact.social && currentData.personal.contact.social.linkedin) {
                    document.getElementById('personal-linkedin').value = currentData.personal.contact.social.linkedin;
                }
            }
        }

        async function savePersonalInfo() {
            // Prepare the updated personal data structure
            const updatedPersonal = {
                hero: {
                    name: document.getElementById('personal-name').value,
                    title: document.getElementById('personal-title').value,
                    description: document.getElementById('personal-description').value,
                    cta: currentData.personal.hero?.cta || {
                        primary: { text: "See Projects", link: "/projects.html" },
                        secondary: { text: "Contact", link: "/contact.html" }
                    },
                    quickInfo: [
                        {
                            icon: "fas fa-map-marker-alt",
                            text: document.getElementById('personal-location').value
                        },
                        {
                            icon: "fas fa-university",
                            text: document.getElementById('personal-university').value
                        },
                        {
                            icon: "fas fa-language",
                            text: document.getElementById('personal-languages').value
                        }
                    ],
                    highlights: document.getElementById('personal-highlights').value.split('\n').filter(h => h.trim()),
                    links: [
                        {
                            text: "Portfolio",
                            url: document.getElementById('personal-portfolio').value,
                            external: true
                        },
                        {
                            text: "LinkedIn",
                            url: document.getElementById('personal-linkedin').value,
                            external: true
                        }
                    ]
                },
                about: {
                    title: "About",
                    content: [
                        document.getElementById('personal-about-1').value,
                        document.getElementById('personal-about-2').value,
                        document.getElementById('personal-about-3').value,
                        document.getElementById('personal-about-4').value
                    ].filter(content => content.trim()),
                    atAGlance: document.getElementById('personal-skills').value.split('\n').filter(skill => skill.trim())
                },
                contact: {
                    email: document.getElementById('personal-email').value,
                    social: {
                        linkedin: document.getElementById('personal-linkedin').value,
                        twitter: currentData.personal.contact?.social?.twitter || null,
                        instagram: currentData.personal.contact?.social?.instagram || null,
                        github: currentData.personal.contact?.social?.github || null
                    },
                    availability: currentData.personal.contact?.availability || "Open to new projects and collaborations"
                }
            };

            currentData.personal = updatedPersonal;
            showStatus('Personal information saved successfully!', 'success');
            await saveDataToAPI('personal');
        }

        function previewPersonalInfo() {
            const info = {
                hero: {
                    name: document.getElementById('personal-name').value,
                    title: document.getElementById('personal-title').value,
                    description: document.getElementById('personal-description').value,
                    location: document.getElementById('personal-location').value,
                    university: document.getElementById('personal-university').value,
                    languages: document.getElementById('personal-languages').value,
                    highlights: document.getElementById('personal-highlights').value.split('\n').filter(h => h.trim()),
                    portfolioUrl: document.getElementById('personal-portfolio').value,
                    linkedinUrl: document.getElementById('personal-linkedin').value
                },
                about: {
                    content: [
                        document.getElementById('personal-about-1').value,
                        document.getElementById('personal-about-2').value,
                        document.getElementById('personal-about-3').value,
                        document.getElementById('personal-about-4').value
                    ].filter(content => content.trim()),
                    skills: document.getElementById('personal-skills').value.split('\n').filter(skill => skill.trim())
                },
                contact: {
                    email: document.getElementById('personal-email').value
                }
            };

            console.log('Personal Info Preview:', info);
            showStatus('Personal information preview logged to console', 'info');
        }

        // Social Media functions
        function loadSocialMedia() {
            if (currentData.social) {
                // Load social media links
                document.getElementById('social-linkedin').value = currentData.social.linkedin || '';
                document.getElementById('social-github').value = currentData.social.github || '';
                document.getElementById('social-twitter').value = currentData.social.twitter || '';
                document.getElementById('social-instagram').value = currentData.social.instagram || '';
                document.getElementById('social-facebook').value = currentData.social.facebook || '';
                document.getElementById('social-dribbble').value = currentData.social.dribbble || '';
                document.getElementById('social-behance').value = currentData.social.behance || '';
                document.getElementById('social-youtube').value = currentData.social.youtube || '';
                document.getElementById('social-tiktok').value = currentData.social.tiktok || '';
                document.getElementById('social-discord').value = currentData.social.discord || '';
                document.getElementById('social-website').value = currentData.social.website || '';
                document.getElementById('social-portfolio').value = currentData.social.portfolio || '';
                
                // Load contact information
                document.getElementById('social-email').value = currentData.social.email || '';
                document.getElementById('social-phone').value = currentData.social.phone || '';
                document.getElementById('social-whatsapp').value = currentData.social.whatsapp || '';
                document.getElementById('social-telegram').value = currentData.social.telegram || '';
                
                // Load business information
                document.getElementById('social-address').value = currentData.social.address || '';
                document.getElementById('social-hours').value = currentData.social.businessHours || '';
            }
        }

        async function saveSocialMedia() {
            const socialData = {
                // Social media platforms
                linkedin: document.getElementById('social-linkedin').value,
                github: document.getElementById('social-github').value,
                twitter: document.getElementById('social-twitter').value,
                instagram: document.getElementById('social-instagram').value,
                facebook: document.getElementById('social-facebook').value,
                dribbble: document.getElementById('social-dribbble').value,
                behance: document.getElementById('social-behance').value,
                youtube: document.getElementById('social-youtube').value,
                tiktok: document.getElementById('social-tiktok').value,
                discord: document.getElementById('social-discord').value,
                website: document.getElementById('social-website').value,
                portfolio: document.getElementById('social-portfolio').value,
                
                // Contact information
                email: document.getElementById('social-email').value,
                phone: document.getElementById('social-phone').value,
                whatsapp: document.getElementById('social-whatsapp').value,
                telegram: document.getElementById('social-telegram').value,
                
                // Business information
                address: document.getElementById('social-address').value,
                businessHours: document.getElementById('social-hours').value,
                
                // Metadata
                updatedAt: new Date().toISOString()
            };

            currentData.social = socialData;
            showStatus('Social media links saved successfully!', 'success');
            await saveDataToAPI('social');
        }

        function previewSocialMedia() {
            const socialData = {
                linkedin: document.getElementById('social-linkedin').value,
                github: document.getElementById('social-github').value,
                twitter: document.getElementById('social-twitter').value,
                instagram: document.getElementById('social-instagram').value,
                facebook: document.getElementById('social-facebook').value,
                dribbble: document.getElementById('social-dribbble').value,
                behance: document.getElementById('social-behance').value,
                youtube: document.getElementById('social-youtube').value,
                tiktok: document.getElementById('social-tiktok').value,
                discord: document.getElementById('social-discord').value,
                website: document.getElementById('social-website').value,
                portfolio: document.getElementById('social-portfolio').value,
                email: document.getElementById('social-email').value,
                phone: document.getElementById('social-phone').value,
                whatsapp: document.getElementById('social-whatsapp').value,
                telegram: document.getElementById('social-telegram').value,
                address: document.getElementById('social-address').value,
                businessHours: document.getElementById('social-hours').value
            };

            console.log('Social Media Preview:', socialData);
            showStatus('Social media preview logged to console', 'info');
        }

        // Utility functions
        function generateId() {
            return 'item-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function showStatus(message, type) {
            const container = document.getElementById('status-messages');
            const statusDiv = document.createElement('div');
            statusDiv.className = `status-message status-${type}`;
            statusDiv.textContent = message;
            
            container.appendChild(statusDiv);
            
            setTimeout(() => {
                if (container.contains(statusDiv)) {
                    container.removeChild(statusDiv);
                }
            }, 5000);
        }

        // Tag management functions
        function addTag(containerId, tagText) {
            const container = document.getElementById(containerId);
            const input = container.querySelector('.tag-add-input');
            
            if (tagText.trim()) {
                const tag = document.createElement('div');
                tag.className = 'tag';
                tag.innerHTML = `
                    ${tagText}
                    <button type="button" class="tag-remove" onclick="this.parentElement.remove()">&times;</button>
                `;
                container.insertBefore(tag, input);
            }
        }

        function getTags(containerId) {
            const container = document.getElementById(containerId);
            const tags = container.querySelectorAll('.tag');
            return Array.from(tags).map(tag => tag.textContent.replace('√ó', '').trim());
        }

        // Add event listeners for tag inputs
        document.addEventListener('keypress', function(e) {
            if (e.target.classList.contains('tag-add-input') && e.key === 'Enter') {
                e.preventDefault();
                const tagText = e.target.value.trim();
                if (tagText) {
                    addTag(e.target.parentElement.id, tagText);
                    e.target.value = '';
                }
            }
        });

        // Auto-generate slug from blog title
        document.addEventListener('input', function(e) {
            if (e.target.id === 'blog-title') {
                const slugField = document.getElementById('blog-slug');
                if (slugField && !slugField.value) {
                    slugField.value = generateSlug(e.target.value);
                }
            }
        });

        // Save data to file (works in both development and production)
        async function saveDataToAPI(section) {
            try {
                // Check if user is authenticated
                if (!window.adminAuth || !window.adminAuth.isAuthenticated()) {
                    showStatus('Please login first', 'error');
                    return false;
                }

                const isLocal = (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1');
                if (!isLocal) {
                    // Validate and sanitize data before sending
                    let sanitizedData = currentData[section];
                    if (window.inputValidator) {
                        sanitizedData = window.inputValidator.sanitizeFormData(currentData[section]);
                    }

                    // Check data size before sending
                    const dataString = JSON.stringify(sanitizedData);
                    const dataSizeKB = (dataString.length / 1024).toFixed(1);
                    
                    if (dataString.length > 1024 * 1024) { // 1MB limit
                        showStatus(`Data too large (${dataSizeKB}KB). Consider using external image URLs instead of uploaded files.`, 'error');
                        return false;
                    }
                    
                    // Get authentication token (password hash)
                    const authToken = localStorage.getItem('admin_password_hash');
                    if (!authToken) {
                        showStatus('Authentication token missing. Please login again.', 'error');
                        window.adminAuth.logout();
                        return false;
                    }
                    
                    // Production: use API to save data with authentication
                    const headers = {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    };
                    
                    // Add CSRF token if available
                    if (window.csrfProtection) {
                        const csrfToken = window.csrfProtection.getToken();
                        headers['X-CSRF-Token'] = csrfToken;
                    }

                    const response = await fetch(`/api/data/${section}`, {
                        method: 'POST',
                        headers: headers,
                        body: JSON.stringify({ 
                            data: sanitizedData,
                            csrf_token: window.csrfProtection?.getToken()
                        })
                    });

                    if (response.ok) {
                        const result = await response.json();
                        showStatus(`${section} data committed to repository! (${dataSizeKB}KB)`, 'success');
                        return true;
                    } else {
                        // Attempt to extract JSON error details
                        let details = '';
                        try { 
                            const errorData = await response.json();
                            details = errorData.details || errorData.error || '';
                        } catch {
                            details = await response.text();
                        }

                        if (response.status === 401) {
                            showStatus('Unauthorized. Please login again.', 'error');
                            window.adminAuth.logout();
                        } else if (response.status === 403) {
                            showStatus('CSRF validation failed. Please refresh the page and try again.', 'error');
                        } else if (response.status === 413) {
                            showStatus(`Data payload too large (${dataSizeKB}KB). Use external image URLs for better performance.`, 'error');
                        } else if (response.status === 429) {
                            showStatus('Too many requests. Please wait a moment and try again.', 'error');
                        } else if (response.status === 501) {
                            showStatus(`Persistence not configured. Set GITHUB_TOKEN, GITHUB_OWNER, GITHUB_REPO, ADMIN_PASSWORD_HASH in Vercel env settings. (${section})`, 'info');
                        } else {
                            showStatus(`Failed to save ${section} (status ${response.status}). ${details.substring(0,180)}`, 'error');
                        }
                        return false;
                    }
                } else {
                    // Development: download JSON file for manual replacement
                    downloadUpdatedJSON(section);
                    return true;
                }
            } catch (error) {
                console.error(`Error saving ${section}:`, error);
                showStatus(`Failed to save ${section} data: ${error.message}`, 'error');
                return false;
            }
        }

        // Download updated JSON file (for development)
        function downloadUpdatedJSON(section) {
            const data = JSON.stringify(currentData[section], null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${section}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showStatus(`${section}.json file downloaded! Replace the file in your /data/ folder and refresh your website to see changes.`, 'info');
        }

        // Image handling functions
        function handleImageUpload(section) {
            const fileInput = document.getElementById(`${section}-image-file`);
            const urlInput = document.getElementById(`${section}-image`);
            const preview = document.getElementById(`${section}-image-preview`);
            
            const file = fileInput.files[0];
            if (!file) return;
            
            // Enhanced file validation
            const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/webp', 'image/gif'];
            const maxSize = 1 * 1024 * 1024; // 1MB
            const maxDimension = 2048; // Max width/height
            
            // Validate file type
            if (!allowedTypes.includes(file.type)) {
                showStatus('Invalid file type. Only JPEG, PNG, WebP, and GIF images are allowed.', 'error');
                fileInput.value = '';
                return;
            }
            
            // Validate file size
            if (file.size > maxSize) {
                showStatus(`Image file too large (${(file.size / 1024 / 1024).toFixed(1)}MB). Please select an image under 1MB or use an external URL instead.`, 'error');
                fileInput.value = '';
                return;
            }
            
            // Validate filename for security
            const sanitizedName = file.name.replace(/[^a-zA-Z0-9._-]/g, '');
            if (sanitizedName !== file.name) {
                console.warn('Filename contained potentially unsafe characters');
            }
            
            // Create preview and compressed base64 URL
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    // Validate image dimensions
                    if (img.width > maxDimension || img.height > maxDimension) {
                        showStatus(`Image dimensions too large (${img.width}x${img.height}). Maximum allowed: ${maxDimension}x${maxDimension}px`, 'error');
                        fileInput.value = '';
                        return;
                    }
                    
                    // Compress image to reasonable size
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    // Calculate new dimensions (max 800px width)
                    const maxWidth = 800;
                    const maxHeight = 600;
                    let { width, height } = img;
                    
                    if (width > maxWidth) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    }
                    if (height > maxHeight) {
                        width = (width * maxHeight) / height;
                        height = maxHeight;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    // Draw and compress
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // Use higher quality for smaller files, lower for larger
                    const quality = file.size > 500000 ? 0.7 : 0.8;
                    const compressedBase64 = canvas.toDataURL('image/jpeg', quality);
                    
                    // Additional size check after compression
                    if (compressedBase64.length > 1.5 * 1024 * 1024) { // 1.5MB base64 limit
                        showStatus('Compressed image still too large. Please use a smaller image or external URL.', 'error');
                        fileInput.value = '';
                        return;
                    }
                    
                    // Update URL input with compressed base64 data
                    urlInput.value = compressedBase64;
                    
                    // Show preview
                    const originalSize = (file.size / 1024).toFixed(1);
                    const compressedSize = (compressedBase64.length * 0.75 / 1024).toFixed(1); // Approximate
                    showImagePreview(section, compressedBase64, `${sanitizedName} (${originalSize}KB ‚Üí ${compressedSize}KB)`);
                    
                    showStatus(`Image processed and uploaded: ${sanitizedName}`, 'success');
                };
                
                img.onerror = function() {
                    showStatus('Invalid or corrupted image file.', 'error');
                    fileInput.value = '';
                };
                
                img.src = e.target.result;
            };
            
            reader.onerror = function() {
                showStatus('Error reading file.', 'error');
                fileInput.value = '';
            };
            
            reader.readAsDataURL(file);
        }
        
        function previewImageURL(section) {
            const urlInput = document.getElementById(`${section}-image`);
            
            if (!urlInput) {
                console.error(`Input element not found: ${section}-image`);
                return;
            }
            
            const imageUrl = urlInput.value.trim();
            
            if (!imageUrl) {
                clearImagePreview(section);
                return;
            }
            
            // Validate URL format
            if (!imageUrl.startsWith('data:') && !imageUrl.startsWith('http://') && !imageUrl.startsWith('https://') && !imageUrl.startsWith('/')) {
                showStatus('Invalid image URL format.', 'error');
                clearImagePreview(section);
                return;
            }
            
            // Additional validation for external URLs
            if (imageUrl.startsWith('http')) {
                try {
                    const url = new URL(imageUrl);
                    const allowedHosts = ['cloudinary.com', 'imgur.com', 'github.com', 'githubusercontent.com', 'unsplash.com', 'pixabay.com', 'pexels.com'];
                    const isAllowedHost = allowedHosts.some(host => url.hostname.includes(host));
                    
                    if (!isAllowedHost) {
                        console.warn('External image from potentially untrusted source:', url.hostname);
                    }
                } catch (err) {
                    console.error('URL validation error:', err);
                    showStatus('Invalid URL format.', 'error');
                    clearImagePreview(section);
                    return;
                }
            }
            
            // Clear file input when URL is used
            const fileInput = document.getElementById(`${section}-image-file`);
            if (fileInput) {
                fileInput.value = '';
            }
            
            // Show preview
            showImagePreview(section, imageUrl, imageUrl.startsWith('data:') ? 'Base64 Data' : 'External URL');
        }
        
        function showImagePreview(section, imageUrl, info) {
            const preview = document.getElementById(`${section}-image-preview`);
            
            if (!preview) {
                console.error(`Preview element not found: ${section}-image-preview`);
                return;
            }
            
            preview.innerHTML = `
                <img src="${imageUrl}" alt="Preview" class="preview-image" onerror="handleImageError(this, '${section}')">
                <div class="preview-info">${info}</div>
                <div class="image-actions">
                    <button type="button" class="btn-clear-image" onclick="clearImagePreview('${section}')">Remove Image</button>
                </div>
            `;
        }
        
        function clearImagePreview(section) {
            const preview = document.getElementById(`${section}-image-preview`);
            const urlInput = document.getElementById(`${section}-image`);
            const fileInput = document.getElementById(`${section}-image-file`);
            
            if (!preview) {
                console.error(`Preview element not found: ${section}-image-preview`);
                return;
            }
            
            preview.innerHTML = '<div class="preview-placeholder">No image selected</div>';
            if (urlInput) urlInput.value = '';
            if (fileInput) fileInput.value = '';
        }
        
        function handleImageError(img, section) {
            showStatus('Failed to load image. Please check the URL or try a different image.', 'error');
            img.parentElement.innerHTML = '<div class="preview-placeholder" style="color: #dc3545;">Failed to load image</div>';
        }
    </script>
</body>
</html>